<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Explorer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>
  <style>html,body{height:100%}body{background:#0b0c10;color:#e6e8ee}.scroll-thin{scrollbar-width:thin}</style>
  <script src="data.js"></script>
</head>
<body class="min-h-full">
  <div class="grid grid-rows-[auto,1fr] h-screen">
    <header class="sticky top-0 z-10 border-b border-slate-800 bg-slate-900/70 backdrop-blur">
      <div class="flex items-center gap-3 px-4 py-2">
        <div class="flex items-center gap-2 font-semibold">
          <span class="inline-grid place-items-center w-7 h-7 rounded-xl bg-blue-500 text-white shadow">üìÅ</span>
          <span>Explorer</span>
        </div>
        <div class="ml-auto flex items-center gap-2 w-full max-w-xl">
          <div class="relative flex-1">
            <input id="search" placeholder="Search‚Ä¶ (Ctrl+/)" class="w-full rounded-full border border-slate-700 bg-slate-800/70 px-9 py-2 outline-none focus:ring-2 focus:ring-blue-500" />
            <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 opacity-70" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4a6 6 0 1 1 0 12 6 6 0 0 1 0-12zm8.32 12.9 3.39 3.39-1.41 1.41-3.39-3.39A8.96 8.96 0 0 1 10 20 9 9 0 1 1 19 11c0 2.2-.8 4.22-2.11 5.9z"/></svg>
          </div>
          <label class="text-sm text-slate-300">Sort
            <select id="sort" class="ml-2 rounded-lg border border-slate-700 bg-slate-800/70 px-2 py-2">
              <option value="name">Name</option>
              <option value="type">Type</option>
              <option value="size">Size</option>
              <option value="modified">Modified</option>
            </select>
          </label>
          <button id="toggleView" class="rounded-lg border border-slate-700 bg-slate-800/70 px-3 py-2">Toggle View</button>
        </div>
      </div>
    </header>

    <div class="grid grid-cols-[260px,1fr] min-h-0">
      <aside class="border-r border-slate-800 bg-slate-900/40 p-2 overflow-auto scroll-thin">
        <ul id="tree" class="space-y-1"></ul>
      </aside>

      <main class="min-w-0 overflow-auto p-3">
        <nav id="breadcrumbs" class="text-slate-400 text-sm flex items-center gap-1"></nav>
        <section class="mt-3">
          <div id="gridView" class="grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-3"></div>
          <div id="listView" class="hidden"></div>
        </section>
      </main>
    </div>
  </div>

<script>
  let currentPath = ["/"];
  let gridMode = true;
  const $ = (s, r=document) => r.querySelector(s);
  const fmtBytes = n => { if(!n && n!==0) return ""; const u=['B','KB','MB','GB']; let i=0, v=n; while(v>=1024&&i<u.length-1){v/=1024;i++} return `${v.toFixed(v<10&&i>0?1:0)} ${u[i]}`; };
  const fmtDate = t => t ? new Date(t).toLocaleString() : '';
  const getNode = pathArr => { let node = demoFS; for(let i=1;i<pathArr.length;i++){ node = (node.children||[]).find(c=>c.name===pathArr[i]); if(!node) return demoFS; } return node; };
  const fileIcon = it => it.type==='folder'?'üìÇ':'üì¶';

  function renderTree(){
    const ul = $('#tree');
    ul.innerHTML = '';
    (demoFS.children||[]).forEach(child=>{
      const li = document.createElement('li');
      li.innerHTML = `<button class="w-full text-left px-2 py-2 rounded-lg hover:bg-slate-800/70">${fileIcon(child)} <span class=\"ml-1\">${child.name}</span></button>`;
      li.firstElementChild.addEventListener('click', ()=>{ currentPath=['/', child.name]; update(); });
      ul.appendChild(li);
    });
  }
  function renderBreadcrumb(){
    const nav = $('#breadcrumbs');
    nav.innerHTML = '';
    currentPath.forEach((seg,i)=>{
      if(i>0){ const sep=document.createElement('span'); sep.textContent='‚Ä∫'; sep.className='opacity-50'; nav.appendChild(sep); }
      const a=document.createElement('a'); a.href='#'; a.textContent= seg==='/'? 'Home' : seg; a.className='hover:underline';
      a.addEventListener('click', ev=>{ev.preventDefault(); currentPath=currentPath.slice(0,i+1); update();});
      nav.appendChild(a);
    });
  }
  function renderItems(container, items){
    for(const it of items){
      const btn = document.createElement('button');
      btn.className = 'text-left rounded-2xl border border-slate-800 bg-slate-900/60 p-3 hover:-translate-y-0.5';
      btn.innerHTML = `<div class="text-3xl">${fileIcon(it)}</div><div class="mt-2 font-semibold truncate">${it.name}</div><div class="text-xs text-slate-400">${it.type==='folder'?'Folder':fmtBytes(it.size)} ‚Ä¢ ${fmtDate(it.modified)}</div>`;
      btn.addEventListener('dblclick', ()=>{
        if(it.type==='folder'){
          currentPath.push(it.name); update();
        } else {
          if(it.url){
            window.location.href = it.url; // Always provided by generator now
          } else {
            console.error('Missing URL for file', it);
          }
        }
      });
      container.appendChild(btn);
    }
  }
  function renderGrid(){
    const grid = $('#gridView');
    grid.innerHTML = '';
    const node = getNode(currentPath);
    renderItems(grid, node.children||[]);
  }
  function renderList(){
    const root = $('#listView');
    root.innerHTML='';
    const node = getNode(currentPath);
    renderItems(root, node.children||[]);
  }
  function update(){
    renderBreadcrumb();
    if(gridMode){ $('#gridView').classList.remove('hidden'); $('#listView').classList.add('hidden'); renderGrid(); }
    else { $('#gridView').classList.add('hidden'); $('#listView').classList.remove('hidden'); renderList(); }
  }
  $('#toggleView').addEventListener('click', ()=>{ gridMode=!gridMode; update(); });
  $('#search').addEventListener('input', update);
  renderTree();
  update();
</script>
</body>
</html>